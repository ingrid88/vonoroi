
<canvas id="c" width="500px" height="500px"></canvas>
<script>
var e = document.getElementById('c')
var g = e.getContext("2d")
// g.getImageData(mouseX, mouseY, 1, 1).data

WIDTH=500
HEIGHT=500
SEED_COUNT = 30

// Perform Build
SEEDS = add_seeds(SEED_COUNT)

var distance_measure = location.search.split('metric=')[1]
console.log(distance_measure)


pixel_matrix = paint_voronoi();

paint_seeds(3);
RESEEDS = add_seeds(SEED_COUNT*10);
// 1. get reseeds colors
// pixel_color = g.getImageData(p_x,p_y,1,1).data
// 2. for all pixel_matrix with that color perform operation
// 3. perform for each color
// 4. recolor pixels (how?)


console.log(pixel_matrix)

function add_seeds(seed_count){
  var seeds = []
  for(var x=0; x < seed_count; x++) {
    for(var y=0; y < seed_count; y++) {
      u = Math.floor(Math.random()*WIDTH)
      v = Math.floor(Math.random()*HEIGHT)
      seeds[x] = [u,v]
    }
  }
  return seeds
}

function paint_voronoi(){
  pixel_matrix = []
  i = 0
  for(var x=0; x < WIDTH; x++) {
    for(var y=0; y < HEIGHT; y++) {
        seed_index = assign_pixel([x,y], SEEDS, distance_measure)
        g.fillStyle = "hsl("+(360*seed_index/SEED_COUNT)+",60%,60%)"
        g.fillRect(x,y,1,1)
        pixel_matrix[i] = [x,y,seed_index]
        i+=1
    }
  }
  return pixel_matrix
}

function paint_seeds(size){
  SEEDS.forEach(function(seed){
    g.fillStyle = "black"
    g.fillRect(seed[0]-Math.floor(size/2),seed[1]-Math.floor(size/2),size,size)
  })
}

function assign_pixel(pixel, seeds, metric) {
  p_x = pixel[0]
  p_y = pixel[1]
  d = 500
  ind = 0
  for(var x=0; x < seeds.length; x++) {
    s_x = seeds[x][0]
    s_y = seeds[x][1]
    metric = euclidean_distance
    n_d = metric(s_x,s_y,p_x,p_y)
    d = (d < n_d) ? d : n_d
    ind = (d < n_d) ? ind : x
  }
  return ind
}


function l0_space(x,y,u,v) {
    return  Math.max(Math.abs(u-x), Math.abs(v-y))
}

function manhattan_distance(x,y,u,v) {
    return  Math.abs(u-x) + Math.abs(v-y)
}

function euclidean_distance(x,y,u,v) {
     return Math.sqrt(Math.pow((u-x),2) + Math.pow((v-y),2))
}

</script>
